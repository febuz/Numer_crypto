2025-05-06 00:21:51,876 [INFO] Using GPUs: [0, 1, 2]
2025-05-06 00:21:51,876 [INFO] Using synthetic data as requested
2025-05-06 00:21:51,876 [INFO] Creating synthetic data with 100000 samples, 100 assets
2025-05-06 00:22:51,548 [INFO] Created synthetic historical data: (80000, 78)
2025-05-06 00:22:51,549 [INFO] Created synthetic latest data: (20000, 78)
2025-05-06 00:22:51,842 [INFO] Applying advanced feature engineering to historical data
2025-05-06 00:22:51,842 [INFO] Starting advanced feature engineering on dataframe of shape (80000, 78)
2025-05-06 00:22:51,863 [INFO] Starting with 72 base features
2025-05-06 00:22:51,864 [INFO] Creating price-based features
2025-05-06 00:22:51,864 [INFO] Creating asset-specific aggregation features
2025-05-06 00:22:55,123 [INFO] Creating polynomial features of degree 3
2025-05-06 00:22:55,224 [INFO] Creating interaction features between predictors
2025-05-06 00:22:55,245 [INFO] Creating time series features
2025-05-06 00:22:56,788 [INFO] Finalizing feature engineering
2025-05-06 00:22:56,923 [INFO] Feature engineering complete. Final shape: (80000, 201) with 195 features
2025-05-06 00:22:56,928 [INFO] Applying advanced feature engineering to latest data
2025-05-06 00:22:56,928 [INFO] Starting advanced feature engineering on dataframe of shape (20000, 78)
2025-05-06 00:22:56,932 [INFO] Starting with 72 base features
2025-05-06 00:22:56,932 [INFO] Creating price-based features
2025-05-06 00:22:56,932 [INFO] Creating asset-specific aggregation features
2025-05-06 00:22:57,517 [INFO] Creating polynomial features of degree 3
2025-05-06 00:22:57,551 [INFO] Creating interaction features between predictors
2025-05-06 00:22:57,565 [INFO] Creating time series features
2025-05-06 00:22:57,829 [INFO] Finalizing feature engineering
2025-05-06 00:22:57,862 [INFO] Feature engineering complete. Final shape: (20000, 201) with 195 features
2025-05-06 00:22:57,864 [INFO] Splitting historical data into train and validation sets
2025-05-06 00:22:57,933 [INFO] Train data: (64000, 201), Validation data: (16000, 201)
2025-05-06 00:22:58,000 [INFO] Selecting up to 300 best features from 195 total features
2025-05-06 00:22:58,001 [INFO] Already have 195 features which is <= 300, skipping selection
2025-05-06 00:22:58,062 [INFO] Selected 195 features
2025-05-06 00:22:59,480 [INFO] PyTorch MLP using device: cuda:2
2025-05-06 00:22:59,480 [INFO] Training lightgbm model
2025-05-06 00:22:59,598 [INFO] Training LightGBM model with 195 features
2025-05-06 00:22:59,718 [ERROR] Error training lightgbm model: train() got an unexpected keyword argument 'early_stopping_rounds'
2025-05-06 00:22:59,719 [ERROR] Traceback (most recent call last):
  File "/media/knight2/EDB/repos/Numer_crypto/scripts/enhanced_crypto_model.py", line 1444, in main
    model.train(X_train, y_train, X_val, y_val, feature_names=selected_features)
  File "/media/knight2/EDB/repos/Numer_crypto/scripts/enhanced_crypto_model.py", line 652, in train
    self.model = lgb.train(
                 ^^^^^^^^^^
TypeError: train() got an unexpected keyword argument 'early_stopping_rounds'

2025-05-06 00:22:59,719 [INFO] Training xgboost model
2025-05-06 00:22:59,737 [INFO] Training XGBoost model with 195 features
2025-05-06 00:23:02,234 [ERROR] Error training xgboost model: data did not contain feature names, but the following fields are expected: price, market, price_lag_1, price_lag_2, price_lag_3, price_lag_4, price_lag_5, price_lag_6, price_lag_7, price_lag_8, price_lag_9, price_lag_10, price_lag_11, price_lag_12, price_lag_13, price_lag_14, price_lag_15, price_lag_16, price_lag_17, price_lag_18, price_lag_19, price_lag_20, price_lag_21, price_lag_22, price_lag_23, price_lag_24, price_lag_25, price_lag_26, price_lag_27, price_lag_28, price_lag_29, price_lag_30, return_1d, return_2d, return_3d, return_5d, return_7d, return_10d, return_14d, return_21d, return_30d, ma_5, ma_10, ma_cross_5_10, ma_20, ma_cross_5_20, ma_30, ma_cross_5_30, ma_50, ma_cross_5_50, vol_5, vol_10, vol_20, vol_30, momentum_10, momentum_20, momentum_30, rsi_7, rsi_14, rsi_21, dist_ma_10, dist_ma_20, dist_ma_50, market_corr_20, market_corr_30, bb_upper_20, bb_lower_20, bb_width_20, bb_position_20, return_accel_3, return_accel_5, return_accel_10, return_1d_zscore, return_2d_zscore, return_3d_zscore, return_5d_zscore, return_7d_zscore, return_10d_zscore, return_14d_zscore, return_21d_zscore, return_30d_zscore, vol_5_zscore, vol_10_zscore, vol_20_zscore, vol_30_zscore, momentum_10_zscore, momentum_20_zscore, momentum_30_zscore, rsi_7_zscore, rsi_14_zscore, rsi_21_zscore, return_accel_3_zscore, return_accel_5_zscore, return_accel_10_zscore, return_1d_mkt_diff, return_2d_mkt_diff, return_3d_mkt_diff, return_5d_mkt_diff, return_7d_mkt_diff, return_10d_mkt_diff, return_14d_mkt_diff, return_21d_mkt_diff, return_30d_mkt_diff, vol_5_mkt_diff, median_market_corr, return_1d_pow2, return_1d_pow3, return_2d_pow2, return_2d_pow3, return_3d_pow2, return_3d_pow3, return_5d_pow2, return_5d_pow3, return_7d_pow2, return_7d_pow3, momentum_10_pow2, momentum_10_pow3, momentum_20_pow2, momentum_20_pow3, momentum_30_pow2, momentum_30_pow3, momentum_10_zscore_pow2, momentum_10_zscore_pow3, momentum_20_zscore_pow2, momentum_20_zscore_pow3, vol_5_pow2, vol_5_pow3, vol_10_pow2, vol_10_pow3, vol_20_pow2, vol_20_pow3, vol_30_pow2, vol_30_pow3, vol_5_zscore_pow2, vol_5_zscore_pow3, ma_cross_5_10_pow2, ma_cross_5_10_pow3, ma_cross_5_20_pow2, ma_cross_5_20_pow3, ma_cross_5_30_pow2, ma_cross_5_30_pow3, ma_cross_5_50_pow2, ma_cross_5_50_pow3, rsi_7_pow2, rsi_7_pow3, return_1d_x_momentum_10, return_1d_div_momentum_10, return_1d_x_momentum_20, return_1d_div_momentum_20, return_2d_x_momentum_10, return_2d_div_momentum_10, return_2d_x_momentum_20, return_2d_div_momentum_20, return_3d_x_momentum_10, return_3d_div_momentum_10, return_3d_x_momentum_20, return_3d_div_momentum_20, return_1d_x_vol_5, return_1d_div_vol_5, return_1d_x_vol_10, return_1d_div_vol_10, return_2d_x_vol_5, return_2d_div_vol_5, return_2d_x_vol_10, return_2d_div_vol_10, return_3d_x_vol_5, return_3d_div_vol_5, return_3d_x_vol_10, return_3d_div_vol_10, momentum_10_x_vol_5, momentum_10_div_vol_5, momentum_10_x_vol_10, momentum_10_div_vol_10, momentum_20_x_vol_5, momentum_20_div_vol_5, momentum_20_x_vol_10, momentum_20_div_vol_10, return_1d_lag1, return_5d_lag1, return_10d_lag1, return_1d_lag2, return_5d_lag2, return_10d_lag2, return_1d_lag3, return_5d_lag3, return_10d_lag3, return_1d_lag4, return_5d_lag4, return_10d_lag4, return_1d_expand_mean, return_1d_dev_mean, vol_10_expand_mean, vol_10_dev_mean, momentum_10_expand_mean, momentum_10_dev_mean
2025-05-06 00:23:02,235 [ERROR] Traceback (most recent call last):
  File "/media/knight2/EDB/repos/Numer_crypto/scripts/enhanced_crypto_model.py", line 1448, in main
    results = evaluate_model(model, X_val, y_val)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/media/knight2/EDB/repos/Numer_crypto/scripts/enhanced_crypto_model.py", line 1196, in evaluate_model
    preds = model.predict(X)
            ^^^^^^^^^^^^^^^^
  File "/media/knight2/EDB/repos/Numer_crypto/scripts/enhanced_crypto_model.py", line 760, in predict
    return self.model.predict(dtest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/media/knight2/EDB/repos/Numer_crypto/venv/lib/python3.12/site-packages/xgboost/core.py", line 729, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/media/knight2/EDB/repos/Numer_crypto/venv/lib/python3.12/site-packages/xgboost/core.py", line 2502, in predict
    self._validate_features(fn)
  File "/media/knight2/EDB/repos/Numer_crypto/venv/lib/python3.12/site-packages/xgboost/core.py", line 3215, in _validate_features
    raise ValueError(
ValueError: data did not contain feature names, but the following fields are expected: price, market, price_lag_1, price_lag_2, price_lag_3, price_lag_4, price_lag_5, price_lag_6, price_lag_7, price_lag_8, price_lag_9, price_lag_10, price_lag_11, price_lag_12, price_lag_13, price_lag_14, price_lag_15, price_lag_16, price_lag_17, price_lag_18, price_lag_19, price_lag_20, price_lag_21, price_lag_22, price_lag_23, price_lag_24, price_lag_25, price_lag_26, price_lag_27, price_lag_28, price_lag_29, price_lag_30, return_1d, return_2d, return_3d, return_5d, return_7d, return_10d, return_14d, return_21d, return_30d, ma_5, ma_10, ma_cross_5_10, ma_20, ma_cross_5_20, ma_30, ma_cross_5_30, ma_50, ma_cross_5_50, vol_5, vol_10, vol_20, vol_30, momentum_10, momentum_20, momentum_30, rsi_7, rsi_14, rsi_21, dist_ma_10, dist_ma_20, dist_ma_50, market_corr_20, market_corr_30, bb_upper_20, bb_lower_20, bb_width_20, bb_position_20, return_accel_3, return_accel_5, return_accel_10, return_1d_zscore, return_2d_zscore, return_3d_zscore, return_5d_zscore, return_7d_zscore, return_10d_zscore, return_14d_zscore, return_21d_zscore, return_30d_zscore, vol_5_zscore, vol_10_zscore, vol_20_zscore, vol_30_zscore, momentum_10_zscore, momentum_20_zscore, momentum_30_zscore, rsi_7_zscore, rsi_14_zscore, rsi_21_zscore, return_accel_3_zscore, return_accel_5_zscore, return_accel_10_zscore, return_1d_mkt_diff, return_2d_mkt_diff, return_3d_mkt_diff, return_5d_mkt_diff, return_7d_mkt_diff, return_10d_mkt_diff, return_14d_mkt_diff, return_21d_mkt_diff, return_30d_mkt_diff, vol_5_mkt_diff, median_market_corr, return_1d_pow2, return_1d_pow3, return_2d_pow2, return_2d_pow3, return_3d_pow2, return_3d_pow3, return_5d_pow2, return_5d_pow3, return_7d_pow2, return_7d_pow3, momentum_10_pow2, momentum_10_pow3, momentum_20_pow2, momentum_20_pow3, momentum_30_pow2, momentum_30_pow3, momentum_10_zscore_pow2, momentum_10_zscore_pow3, momentum_20_zscore_pow2, momentum_20_zscore_pow3, vol_5_pow2, vol_5_pow3, vol_10_pow2, vol_10_pow3, vol_20_pow2, vol_20_pow3, vol_30_pow2, vol_30_pow3, vol_5_zscore_pow2, vol_5_zscore_pow3, ma_cross_5_10_pow2, ma_cross_5_10_pow3, ma_cross_5_20_pow2, ma_cross_5_20_pow3, ma_cross_5_30_pow2, ma_cross_5_30_pow3, ma_cross_5_50_pow2, ma_cross_5_50_pow3, rsi_7_pow2, rsi_7_pow3, return_1d_x_momentum_10, return_1d_div_momentum_10, return_1d_x_momentum_20, return_1d_div_momentum_20, return_2d_x_momentum_10, return_2d_div_momentum_10, return_2d_x_momentum_20, return_2d_div_momentum_20, return_3d_x_momentum_10, return_3d_div_momentum_10, return_3d_x_momentum_20, return_3d_div_momentum_20, return_1d_x_vol_5, return_1d_div_vol_5, return_1d_x_vol_10, return_1d_div_vol_10, return_2d_x_vol_5, return_2d_div_vol_5, return_2d_x_vol_10, return_2d_div_vol_10, return_3d_x_vol_5, return_3d_div_vol_5, return_3d_x_vol_10, return_3d_div_vol_10, momentum_10_x_vol_5, momentum_10_div_vol_5, momentum_10_x_vol_10, momentum_10_div_vol_10, momentum_20_x_vol_5, momentum_20_div_vol_5, momentum_20_x_vol_10, momentum_20_div_vol_10, return_1d_lag1, return_5d_lag1, return_10d_lag1, return_1d_lag2, return_5d_lag2, return_10d_lag2, return_1d_lag3, return_5d_lag3, return_10d_lag3, return_1d_lag4, return_5d_lag4, return_10d_lag4, return_1d_expand_mean, return_1d_dev_mean, vol_10_expand_mean, vol_10_dev_mean, momentum_10_expand_mean, momentum_10_dev_mean

2025-05-06 00:23:02,236 [INFO] Training pytorch_mlp model
2025-05-06 00:23:02,236 [INFO] Training PyTorch MLP model with 195 features
2025-05-06 00:23:14,015 [INFO] Epoch 10, Train Loss: 0.082940, Val Loss: 0.076540
2025-05-06 00:23:25,241 [INFO] Epoch 20, Train Loss: 0.082812, Val Loss: 0.076515
2025-05-06 00:23:38,901 [INFO] Epoch 30, Train Loss: 0.082724, Val Loss: 0.076451
